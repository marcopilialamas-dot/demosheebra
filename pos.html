<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    <title>POS Demo Sheebra ü¶ì</title>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600;800&display=swap" rel="stylesheet">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/vue/3.2.47/vue.global.prod.min.js"></script>
    <style>
        :root { --p: #4f46e5; --bg: #f3f4f6; --c: #111827; --w: #ffffff; }
        
        /* LAYOUT PRINCIPAL (Correcci√≥n de Scroll) */
        body { 
            font-family: 'Inter', sans-serif; 
            background: var(--bg); 
            color: var(--c); 
            margin: 0; 
            display: flex; 
            flex-direction: column; 
            height: 100dvh; /* Usamos dvh para m√≥viles */
            overflow: hidden; 
        }
        
        /* HEADER STYLES */
        .header { 
            background: white; 
            padding: 15px; 
            display: flex; 
            justify-content: space-between; 
            align-items: center; 
            border-bottom: 1px solid #eee;
            flex-shrink: 0; /* Evita que se aplaste */
        }
        .brand { font-weight: 800; color: var(--p); font-size: 18px; display: block;}
        .badge { padding: 4px 8px; border-radius: 6px; font-size: 11px; font-weight: bold; background: #dbeafe; color: #1e40af; }

        /* SEARCH */
        .search-bar-container { 
            padding: 10px; 
            background: white; 
            border-bottom: 1px solid #eee; 
            flex-shrink: 0;
        }
        input { padding: 12px; border: 1px solid #d1d5db; border-radius: 10px; width: 100%; box-sizing: border-box; font-size: 16px; outline: none; background: #f9fafb; }
        
        /* CONTENIDO EN GRILLA (CUADROS FLOTANTES) */
       /* CONTENIDO EN GRILLA (CORREGIDO PARA SCROLL) */
       /* CONTENIDO EN GRILLA (CORREGIDO PARA SCROLL) */
       /* BUSCA ESTA PARTE EN TU CSS */
        .content { 
            flex: 1; 
            overflow-y: auto; 
            padding: 10px; 
            padding-bottom: 120px;
            -webkit-overflow-scrolling: touch; 
            
            /* üëá AGREGAR ESTO S√ç O S√ç üëá */
            min-height: 0; 
            /* üëÜ SIN ESTO, EL SCROLL SE TRABA EN M√ìVILES */

            /* GRILLA */
            display: grid;
            grid-template-columns: repeat(2, 1fr); 
            gap: 10px;
            align-content: start;
        }
        
        /* TARJETA DE PRODUCTO (CUADRADA) */
        .prod-card { 
            background: white; 
            padding: 15px; 
            border-radius: 12px; 
            display: flex; 
            flex-direction: column; /* Vertical */
            justify-content: center; 
            align-items: center; 
            text-align: center;
            box-shadow: 0 2px 4px rgba(0,0,0,0.05); 
            transition: transform 0.1s; 
            border: 1px solid transparent;
            height: 110px; /* Altura fija para que sean cuadrados */
            cursor: pointer;
            position: relative;
        }
        .prod-card:active { transform: scale(0.96); border-color: var(--p); background: #eef2ff; }
        
        .prod-name { font-weight: 600; margin-bottom: 5px; font-size: 14px; line-height: 1.2;}
        .prod-sku { font-size: 10px; color: #9ca3af; margin-bottom: 5px; }
        .prod-price { font-weight: 800; color: var(--p); font-size: 18px; }
        
        /* BOLITA DE CANTIDAD (SI YA ESTA EN CARRITO) */
        .qty-badge {
            position: absolute; top: 5px; right: 5px;
            background: var(--p); color: white;
            width: 20px; height: 20px; border-radius: 50%;
            font-size: 10px; display: flex; align-items: center; justify-content: center;
            font-weight: bold;
        }

        /* BOTTOM CART BAR */
        .cart-bar { position: fixed; bottom: 0; left: 0; width: 100%; background: white; border-top: 1px solid #eee; padding: 15px; box-sizing: border-box; display: flex; justify-content: space-between; align-items: center; box-shadow: 0 -2px 10px rgba(0,0,0,0.05); z-index: 100; cursor: pointer; }
        .cart-info { display: flex; flex-direction: column; }
        .total-price { font-size: 20px; font-weight: 800; color: var(--p); }
        .item-count { font-size: 12px; color: #6b7280; font-weight: 600; }
        .btn-checkout { background: #16a34a; color: white; border: none; padding: 12px 25px; border-radius: 10px; font-weight: 700; font-size: 16px; }

        /* CART MODAL OVERLAY */
        .cart-overlay { position: fixed; inset: 0; background: rgba(0,0,0,0.5); z-index: 200; display: flex; justify-content: flex-end; flex-direction: column; }
        .cart-sheet { background: white; border-radius: 20px 20px 0 0; padding: 20px; max-height: 80vh; display: flex; flex-direction: column; }
        .cart-header { display: flex; justify-content: space-between; align-items: center; margin-bottom: 20px; }
        .cart-items-list { flex: 1; overflow-y: auto; margin-bottom: 20px; }
        .cart-item { display: flex; justify-content: space-between; align-items: center; padding: 10px 0; border-bottom: 1px solid #eee; }
        .qty-ctrl { display: flex; align-items: center; gap: 10px; background: #f3f4f6; padding: 5px; border-radius: 8px; }
        .qty-btn { width: 30px; height: 30px; border: none; background: white; border-radius: 6px; font-weight: bold; box-shadow: 0 1px 2px rgba(0,0,0,0.1); }
        .btn-pay-big { width: 100%; padding: 15px; background: var(--p); color: white; border: none; border-radius: 12px; font-size: 18px; font-weight: 800; }
        
        .cta-float-pos { position: fixed; bottom: 90px; right: 20px; background: #16a34a; color: white; padding: 8px 15px; border-radius: 50px; font-weight: bold; box-shadow: 0 4px 10px rgba(0,0,0,0.2); z-index: 90; text-decoration: none; font-size: 12px; display: flex; align-items: center; gap: 5px;}
        .loading { position: fixed; inset: 0; background: rgba(255, 255, 255, 0.9); display: flex; flex-direction: column; align-items: center; justify-content: center; z-index: 9999; }
        .spinner { border: 4px solid #f3f3f3; border-top: 4px solid var(--p); border-radius: 50%; width: 40px; height: 40px; animation: spin 1s linear infinite; margin-bottom: 15px; }
        @keyframes spin { 0% { transform: rotate(0deg); } 100% { transform: rotate(360deg); } }
    </style>
</head>
<body>
    <div id="app">
        
        <a href="https://wa.me/5492984902888?text=Hola!%20Vi%20la%20demo%20POS%20de%20Sheebra%20y%20quiero%20saber%20mas" target="_blank" class="cta-float-pos">
            <span>üöÄ ¬øLO QUIERES?</span>
        </a>

        <div class="header">
            <div>
                <div class="brand">Sheebra POS ü¶ì</div>
                <a href="/" style="font-size:11px; color:#4f46e5; text-decoration:none; font-weight:bold">üëâ Ir al Admin (Due√±o)</a>
            </div>
            <div class="badge">MODO CAJERO</div>
        </div>

        <div class="search-bar-container">
            <input v-model="searchQuery" placeholder="üîç Buscar productos..." autofocus>
        </div>

        <div class="content">
            <div v-for="p in filteredProducts" :key="p[0]" class="prod-card" @click="addToCart(p)">
                <div v-if="getQtyInCart(p[0]) > 0" class="qty-badge">{{ getQtyInCart(p[0]) }}</div>
                
                <div class="prod-name">{{ p[1] }}</div>
                <div class="prod-sku">{{ p[0] }}</div>
                <div class="prod-price">${{ p[2] }}</div>
            </div>
            
            <div v-if="filteredProducts.length === 0" style="grid-column: span 2; text-align: center; color: #999; margin-top: 30px;">
                No encontrado ü§∑‚Äç‚ôÇÔ∏è
            </div>
        </div>

        <div class="cart-bar" @click="showCart = true" v-if="cart.length > 0">
            <div class="cart-info">
                <div class="total-price">{{ formatPrice(cartTotal) }}</div>
                <div class="item-count">{{ cartCount }} items</div>
            </div>
            <button class="btn-checkout">Ver Carrito</button>
        </div>

        <div v-if="showCart" class="cart-overlay" @click.self="showCart = false">
            <div class="cart-sheet">
                <div class="cart-header">
                    <h2 style="margin:0">Tu Carrito ({{cartCount}})</h2>
                    <button @click="showCart = false" style="border:none; background:none; font-size:24px; color:#999">√ó</button>
                </div>
                
                <div class="cart-items-list">
                    <div v-for="(item, index) in cart" :key="index" class="cart-item">
                        <div style="flex: 1;">
                            <div style="font-weight: 600;">{{ item.p[1] }}</div>
                             <div style="color: var(--p); font-weight: bold;">{{ formatPrice(item.p[2] * item.qty) }}</div>
                        </div>
                        <div class="qty-ctrl">
                            <button class="qty-btn" @click="updateQty(index, -1)">-</button>
                            <span style="font-weight:bold; width: 20px; text-align: center;">{{ item.qty }}</span>
                            <button class="qty-btn" @click="updateQty(index, 1)">+</button>
                        </div>
                    </div>
                </div>

                <div style="margin-bottom: 10px; display: flex; justify-content: space-between; align-items: center;">
                    <span style="font-size: 18px; color: #666;">Total a Pagar:</span>
                    <span style="font-size: 28px; font-weight: 800; color: var(--p);">{{ formatPrice(cartTotal) }}</span>
                </div>
                 <button class="btn-pay-big" @click="fakeCheckout">‚úÖ COBRAR AHORA (Demo)</button>
            </div>
        </div>

         <div v-if="loading" class="loading">
            <div class="spinner"></div>
            <div style="font-weight: bold; font-size: 18px;">Procesando Venta...</div>
            <div style="color: #666; margin-top: 5px;">(Imprimiendo ticket simulado)</div>
        </div>

    </div>

    <script>
        const { createApp } = Vue;
        createApp({
            data() {
                return {
                    searchQuery: '',
                    showCart: false,
                    loading: false,
                    cart: [],
                    products: [
                        ['SKU101', 'Coca Cola 2.25L', 3200],
                        ['SKU102', 'Fernet Branca 750ml', 8500],
                        ['SKU103', 'Alfajor Jorgito', 800],
                        ['SKU104', 'Cerveza Quilmes 1L', 2500],
                        ['SKU105', 'Gomitas Mogul', 1200],
                        ['SKU106', 'Papel Higienico x4', 4500],
                        ['SKU107', 'Yerba Playadito 500g', 3800],
                        ['SKU108', 'Pan Lactal Bimbo', 2800],
                        ['SKU109', 'Leche La Seren√≠sima', 1500],
                        ['SKU110', 'Detergente Ala', 2100],
                        ['SKU111', 'Galletitas Oreos', 1800],
                        ['SKU112', 'Arroz Gallo 1kg', 1300],
                    ]
                }
            },
            computed: {
                filteredProducts() {
                    const q = this.searchQuery.toUpperCase();
                    if (!q) return this.products; 
                    return this.products.filter(p => p[1].toUpperCase().includes(q) || p[0].includes(q));
                },
                cartTotal() {
                    return this.cart.reduce((total, item) => total + (item.p[2] * item.qty), 0);
                },
                cartCount() {
                    return this.cart.reduce((count, item) => count + item.qty, 0);
                }
            },
            methods: {
                formatPrice(value) { return '$' + value.toLocaleString('es-AR'); },
                
                // --- NUEVO: OBTENER CANTIDAD EN CARRITO PARA MOSTRAR EN LA TARJETA ---
                getQtyInCart(sku) {
                    const item = this.cart.find(i => i.p[0] === sku);
                    return item ? item.qty : 0;
                },

                addToCart(product) {
                    const existingItem = this.cart.find(item => item.p[0] === product[0]);
                    if (existingItem) {
                        existingItem.qty++;
                    } else {
                        this.cart.push({ p: product, qty: 1 });
                    }
                    if (navigator.vibrate) navigator.vibrate(50);
                    this.searchQuery = ''; 
                },
                updateQty(index, change) {
                    this.cart[index].qty += change;
                    if (this.cart[index].qty <= 0) {
                        this.cart.splice(index, 1);
                    }
                    if (this.cart.length === 0) this.showCart = false;
                },
                fakeCheckout() {
                    if(this.cart.length === 0) return;
                    this.loading = true;
                    this.showCart = false;
                    setTimeout(() => {
                        this.loading = false;
                        this.cart = []; 
                        alert("‚ú® ¬°VENTA EXITOSA!\n\nEl ticket se ha impreso y la caja se abri√≥. (Fin de la demo POS)");
                    }, 2000); 
                }
            }
        }).mount('#app');
    </script>
</body>
</html>
